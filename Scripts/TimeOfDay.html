<!DOCTYPE html>
<html lang=en theme=dark>
<head>
<title>Unity Scripts - TimeOfDay.cs</title>
</head>
<body>
<section>
<button onclick="window.location.href='../index.html'"><- Back...</button>
</section>
<section>
<left>
<h1>TimeOfDay.cs</h1>
<button onclick="window.open('https://drive.google.com/uc?export=download&id=1BpFVyec7t3qB_l8vjkQY-Vr1Q0AXrs-f')">Download</button>
<h1>Version 3:</h1>
This script is used to add daylight cycling to your game for better immersion and/or detail
<h1>Method names:</h1>
(There are none)
</left>
<right>
<textarea readonly>using System;
using System.Collections;
using System.Collections.Generic;
using System.Numerics;
using System.Security;
using System.Security.Cryptography;
using UnityEngine;

public class TimeOfDay : MonoBehaviour
{
    public Light directionalLight;
    public bool matchRealtime;
    public string startingTime;
    public string dayLength;
    public string currentTime;
    public bool includeSeconds;
    public bool militaryTime;
    private float currentTimeInSeconds;
    float dayLengthSeconds;
    void Start()
    {
        dayLengthSeconds = ParseFlexibleTime(dayLength);
        if (dayLengthSeconds <= 0f)
            dayLengthSeconds = 86400f;
        if (matchRealtime)
        {
            DateTime now = DateTime.Now;
            currentTimeInSeconds = now.Hour * 3600 + now.Minute * 60 + now.Second;
        }
        else
        {
            currentTimeInSeconds = ParseClockTime(startingTime);
        }
        UpdateCurrentTimeString();
        UpdateLight();
    }
    void Update()
    {
        if (!matchRealtime)
        {
            currentTimeInSeconds += Time.deltaTime * (86400f / dayLengthSeconds);
            if (currentTimeInSeconds >= 86400f)
            {
                currentTimeInSeconds %= 86400f;
            }
        }
        UpdateCurrentTimeString();
        UpdateLight();
    }
    void UpdateCurrentTimeString()
    {
        int t = Mathf.FloorToInt(currentTimeInSeconds);
        int h24 = (t / 3600) % 24;
        int m = (t / 60) % 60;
        int s = t % 60;
        if (militaryTime)
        {
            currentTime = includeSeconds
                ? $"{h24:00}:{m:00}:{s:00}"
                : $"{h24:00}:{m:00}";
        }
        else
        {
            bool pm = h24 >= 12;
            int h12 = h24 % 12;
            if (h12 == 0) h12 = 12;
            currentTime = includeSeconds
                ? $"{h12}:{m:00}:{s:00} {(pm ? "PM" : "AM")}"
                : $"{h12}:{m:00} {(pm ? "PM" : "AM")}";
        }
    }
    void UpdateLight()
    {
        if (directionalLight == null)
            return;
        float normalized = currentTimeInSeconds / 86400f;
        float angle = normalized * 360f;
        directionalLight.transform.rotation = UnityEngine.Quaternion.Euler(angle - 90f, 170f, 0f);
    }
    float ParseClockTime(string time)
    {
        if (string.IsNullOrEmpty(time))
            return 0f;
        time = time.Trim().ToUpper();
        bool pm = time.EndsWith("PM");
        bool am = time.EndsWith("AM");
        time = time.Replace("AM", "").Replace("PM", "").Trim();
        string[] p = time.Split(':');
        int h = 0, m = 0, s = 0;
        if (p.Length >= 1) h = int.Parse(p[0]);
        if (p.Length >= 2) m = int.Parse(p[1]);
        if (p.Length >= 3) s = int.Parse(p[2]);
        if (!militaryTime)
        {
            if (pm && h < 12) h += 12;
            if (am && h == 12) h = 0;
        }
        return h * 3600 + m * 60 + s;
    }
    float ParseFlexibleTime(string value)
    {
        if (string.IsNullOrEmpty(value))
            return 0f;
        string[] p = value.Split(':');
        int[] mult = { 1, 60, 3600, 86400, 2592000, 31536000 };
        float total = 0f;
        for (int i = 0; i < p.Length && i < mult.Length; i++)
            total += int.Parse(p[p.Length - 1 - i]) * mult[i];
        return total;
    }
}</textarea>
</right>
</section>
</body>
<script src=https://gabriellgalvez44.github.io/Data/shorten.js></script>
<link rel=stylesheet href=../script.css>
</html>
