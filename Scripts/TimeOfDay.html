<!DOCTYPE html>
<html lang=en theme=dark>
<head>
<title>Unity Scripts - TimeOfDay.cs</title>
</head>
<body>
<section>
<button onclick="window.location.href='../index.html'"><- Back...</button>
</section>
<section>
<left>
<h1>TimeOfDay.cs</h1>
<button onclick="window.open('https://drive.google.com/uc?export=download&id=1BpFVyec7t3qB_l8vjkQY-Vr1Q0AXrs-f')">Download</button>
<h1>Version 2:</h1>
This script is used to add daylight cycling to your game for better immersion and/or detail
<h1>Method names:</h1>
(There are none)
</left>
<right>
<textarea readonly>using System;
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class TimeOfDay : MonoBehaviour
{
    public string startingTime = "12:00 AM";
    public string dayLength = "5:00";
    public string currentTime;
    public bool matchRealtime = false;
    public Light directionalLight;
    private float currentTimeSeconds;
    private float totalDaySeconds;
    void Start()
    {
        totalDaySeconds = ConvertDayLengthToSeconds(dayLength);
        if (!matchRealtime)
        {
            currentTimeSeconds = ConvertToSeconds(startingTime);
        }
        UpdateLighting();
    }
    void Update()
    {
        if (matchRealtime)
        {
            DateTime now = DateTime.Now;
            currentTimeSeconds = now.Hour * 3600 + now.Minute * 60 + now.Second;
        }
        else
        {
            currentTimeSeconds += Time.deltaTime * (86400f / totalDaySeconds);
            if (currentTimeSeconds >= 86400f)
                currentTimeSeconds -= 86400f;
        }
        currentTime = SecondsTo12HourString(currentTimeSeconds);
        UpdateLighting();
    }
    private void UpdateLighting()
    {
        if (directionalLight == null) return;
        float normalizedTime = currentTimeSeconds / 86400f;
        float sunXRotation = Mathf.Lerp(-90f, 270f, normalizedTime);
        directionalLight.transform.rotation = Quaternion.Euler(sunXRotation, 0f, 0f);
    }
    private float ConvertToSeconds(string time)
    {
        if (DateTime.TryParse(time, out DateTime dt))
            return dt.Hour * 3600 + dt.Minute * 60 + dt.Second;
        return 0f;
    }
    private string SecondsTo12HourString(float seconds)
    {
        seconds %= 86400f;
        int hour = Mathf.FloorToInt(seconds / 3600f);
        int minute = Mathf.FloorToInt((seconds % 3600f) / 60f);
        string suffix = hour >= 12 ? "PM" : "AM";
        hour = hour % 12;
        if (hour == 0) hour = 12;
        return $"{hour:00}:{minute:00} {suffix}";
    }
    private float ConvertDayLengthToSeconds(string str)
    {
        if (string.IsNullOrEmpty(str)) return 300f;
        string[] parts = str.Split(':');
        float seconds = 0f;
        int len = parts.Length;
        try
        {
            if (len == 6)
                seconds = int.Parse(parts[0]) * 31536000 + int.Parse(parts[1]) * 2592000 + int.Parse(parts[2]) * 86400 +
                          int.Parse(parts[3]) * 3600 + int.Parse(parts[4]) * 60 + int.Parse(parts[5]);
            else if (len == 5)
                seconds = int.Parse(parts[0]) * 2592000 + int.Parse(parts[1]) * 86400 +
                          int.Parse(parts[2]) * 3600 + int.Parse(parts[3]) * 60 + int.Parse(parts[4]);
            else if (len == 4)
                seconds = int.Parse(parts[0]) * 86400 + int.Parse(parts[1]) * 3600 +
                          int.Parse(parts[2]) * 60 + int.Parse(parts[3]);
            else if (len == 3)
                seconds = int.Parse(parts[0]) * 3600 + int.Parse(parts[1]) * 60 + int.Parse(parts[2]);
            else if (len == 2)
                seconds = int.Parse(parts[0]) * 60 + int.Parse(parts[1]);
            else if (len == 1)
                seconds = float.Parse(parts[0]);
        }
        catch
        {
            seconds = 300f;
        }
        return seconds;
    }
}</textarea>
</right>
</section>
</body>
<script src=https://gabriellgalvez44.github.io/Data/shorten.js></script>
<link rel=stylesheet href=../script.css>
</html>
