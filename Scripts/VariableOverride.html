<!DOCTYPE html>
<html lang=en>
<head>
<title>Unity Scripts - VariableOverride.cs</title>
</head>
<body>
<section>
<button onclick="window.location.href='../index.html'"><- Back...</button>
</section>
<section>
<left>
<h1>VariableOverride.cs</h1>
<button onclick="window.open('https://drive.google.com/uc?export=download&id=115cP7WFXDw6i8H2ZZoUelyenAKlvJ5Ga')">Download</button>
<h1>Version 4:</h1>
This script is used to override variables from script components
<h1>Method names:</h1>
Override
</left>
<right>
<textarea readonly>using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using System.Reflection;

[System.Serializable]
public class VariableCategory
{
    public string name;
    public VariableType type;
    public string value;
    public bool useComponentVar = false;
    public MonoBehaviour sourceComponent;
    public string sourceVariableName;
    public enum VariableType
    {
        String,
        Bool,
        Float,
        Int
    }
}
public class VariableOverride : MonoBehaviour
{
    public MonoBehaviour componentToOverride;
    [SerializeField]
    public VariableCategory[] variables;

    public void Override()
    {
        if (componentToOverride == null)
        {
            Debug.LogError("No component assigned to override!");
            return;
        }
        foreach (var variable in variables)
        {
            if (string.IsNullOrEmpty(variable.name))
            {
                Debug.LogWarning("Variable name is empty for one of the variables.");
                continue;
            }
            if (variable.useComponentVar)
                continue;
            string variableName = FormatVariableName(variable.name);
            FieldInfo field = componentToOverride.GetType().GetField(variableName, BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance);
            if (field == null)
            {
                Debug.LogWarning($"Field '{variableName}' not found in component '{componentToOverride.GetType().Name}'");
                continue;
            }
            object valueToSet = null;
            switch (variable.type)
            {
                case VariableCategory.VariableType.String:
                    valueToSet = variable.value;
                    break;
                case VariableCategory.VariableType.Bool:
                    if (bool.TryParse(variable.value, out bool boolValue))
                        valueToSet = boolValue;
                    else
                        valueToSet = false;
                    break;
                case VariableCategory.VariableType.Float:
                    if (float.TryParse(variable.value, out float floatValue))
                        valueToSet = floatValue;
                    else
                        valueToSet = 0f;
                    break;
                case VariableCategory.VariableType.Int:
                    if (int.TryParse(variable.value, out int intValue))
                        valueToSet = intValue;
                    else
                        valueToSet = 0;
                    break;
            }
            if (valueToSet != null)
            {
                field.SetValue(componentToOverride, valueToSet);
                Debug.Log($"Field '{variableName}' has been overridden with value: {valueToSet}");
            }
        }
    }
    private void Update()
    {
        foreach (var variable in variables)
        {
            if (!variable.useComponentVar || variable.sourceComponent == null || componentToOverride == null)
                continue;
            string targetVariableName = FormatVariableName(variable.name);
            string sourceVariableName = FormatVariableName(variable.sourceVariableName);
            FieldInfo targetField = componentToOverride.GetType().GetField(targetVariableName, BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance);
            FieldInfo sourceField = variable.sourceComponent.GetType().GetField(sourceVariableName, BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance);
            if (targetField == null)
            {
                Debug.LogWarning($"Target field '{targetVariableName}' not found in component '{componentToOverride.GetType().Name}'");
                continue;
            }
            if (sourceField == null)
            {
                Debug.LogWarning($"Source field '{sourceVariableName}' not found in component '{variable.sourceComponent.GetType().Name}'");
                continue;
            }
            object sourceValue = sourceField.GetValue(variable.sourceComponent);
            targetField.SetValue(componentToOverride, sourceValue);
        }
    }
    private string FormatVariableName(string input)
    {
        if (string.IsNullOrWhiteSpace(input)) return string.Empty;
        string[] parts = input.Split(' ');
        for (int i = 0; i < parts.Length; i++)
        {
            if (string.IsNullOrWhiteSpace(parts[i])) continue;
            parts[i] = char.ToUpper(parts[i][0]) + parts[i].Substring(1);
        }
        string noSpaceName = string.Join("", parts);
        return char.ToLower(noSpaceName[0]) + noSpaceName.Substring(1);
    }
}</textarea>
</right>
</section>
</body>
<script src=https://gabriellgalvez44.github.io/Data/shorten.js></script>
<link rel=stylesheet href=../script.css>
</html>
